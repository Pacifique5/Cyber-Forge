const express = require("express");
const VulnerabilityController = require("../controllers/vulnerabilityController");
const authMiddleware = require("../middleware/authMiddleware");

const router = express.Router();

// All vulnerability routes require authentication
router.use(authMiddleware);

// Submit vulnerability reports for a challenge
router.post("/submit", VulnerabilityController.submitReports);

// Get vulnerability reports for a specific challenge (user's own reports)
router.get("/challenge/:challengeId", VulnerabilityController.getReportsByChallenge);

// Get all vulnerability reports by the authenticated user
router.get("/user", VulnerabilityController.getAllUserReports);

module.exports = router;